y = c(29, 40, 24, 46, 26, 55, 22, 52, 27, 29, 21, 22, 33, 31, 34, 45, 32, 37, 34, 37, 20, 33, 36, 27, 34,
      34, 23, 19, 24, 16, 32, 22)
x1 = c(33, 90, 31, 90, 33, 92, 37, 91, 36, 61, 35, 59, 59, 88, 60, 91, 59, 63, 60, 60, 34, 60, 60, 59,
       60, 59, 60, 37, 62, 35, 62, 37)
x2 = c(53, 64, 36, 60, 51, 92, 51, 92, 54, 62, 35, 42, 56, 65, 60, 89, 60, 62, 60, 61, 35, 62, 59, 62,
       62, 62, 36, 35, 38, 35, 61, 37)
x3 = c(3.32, 7.32, 3.10, 7.32, 3.18, 7.45, 3.39, 7.27, 3.20, 3.91, 3.03, 3.75, 4.78, 6.48, 4.72, 6.70,
       4.60, 4.30, 4.53, 4.02, 2.90, 4.02, 4.40, 3.98, 4.31, 4.39, 4.27, 2.75, 4.41, 2.59, 4.39, 2.73)
x4 = c(3.42, 6.70, 3.26, 7.20, 3.18, 7.45, 3.08, 7.26, 3.41, 4.08, 3.03, 3.45, 4.57, 5.80, 4.72, 6.60,
       4.41, 4.30, 4.53, 4.10, 2.95, 3.89, 4.36, 4.02, 4.42, 4.53, 3.94, 2.64, 3.49, 2.59, 4.39, 2.59)
reg = lm(y~x1+x2+x3+x4) #regressão
e2 = residuals(reg)^2  #auxiliar erro ao quadrado
aux = lm(e2 ~ x1+x2+x4) #erro em relação
length(e2) #descobrir o iun
summary(aux)$r.sq #r² 

(LM = 32*0.3222501) #n.R²

pchisq(LM, 3, lower=FALSE) # 3 graus de liberdade, false -> alfa i > 0

# alfa maior que o valor-p. conclusão rejeita-se H0, ou seja, há evidencias que a variância seja uma função linear de x, ,x3, x4


